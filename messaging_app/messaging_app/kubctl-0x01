#!/bin/bash

echo "ğŸ“¦ Scaling deployment to 3 replicas..."
kubectl scale deployment messaging-app --replicas=3

echo "ğŸ“ Waiting 10 seconds for pods to scale..."
sleep 10

echo "ğŸ” Verifying pod status..."
kubectl get pods

echo "ğŸŒ Getting service URL..."
URL=$(minikube service messaging-service --url)

echo "ğŸš€ Running load test with wrk on $URL"
wrk -t2 -c100 -d10s "$URL"

echo "ğŸ“Š Monitoring resource usage..."
kubectl top pods
