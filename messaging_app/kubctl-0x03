#!/bin/bash

echo "ğŸš€ Applying updated deployment (v2.0)..."
kubectl apply -f blue_deployment.yaml

echo "ğŸ”„ Monitoring rollout status..."
kubectl rollout status deployment/messaging-app

echo "ğŸŒ Testing app for availability during rollout..."
for i in {1..10}; do
    curl -s http://localhost:8000/ || echo "âš ï¸ Request failed"
    sleep 2
done

echo "ğŸ“¦ Current pods:"
kubectl get pods
